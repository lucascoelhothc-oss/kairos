const { OpenAI } = require("openai"); const apiKey = process.env.OPENAI_API_KEY; if (!apiKey || apiKey.includes("sk-your")) { module.exports = { callOpenAI: async () => { throw new Error("No Key"); } }; } else { const client = new OpenAI({ apiKey }); exports.callOpenAI = async (sys, msgs) => { const r = await client.chat.completions.create({ model: "gpt-4o-mini", messages: [{ role: "system", content: sys }, ...msgs], temperature: 0.3 }); return { text: r.choices[0].message.content, raw: r }; }; exports.createEmbedding = async (text) => { const r = await client.embeddings.create({ model: "text-embedding-3-small", input: text.replace(/\n/g, ' ') }); return r.data[0].embedding; }; }